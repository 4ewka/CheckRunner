import javax.imageio.ImageIO
import java.awt.image.BufferedImage

plugins {
    id 'java'
}

group 'ru.clevertec'
version '1.0'

repositories {
    mavenCentral()
}

dependencies {
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.7.0'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.8.2'
}

test {
    useJUnitPlatform()
}

class Downloader extends DefaultTask {
    @Input
    String urlAddress

    @OutputFile
    File outputFile

    @TaskAction
    void download() {
        URL url = new URL(urlAddress)
        try {
            BufferedImage image = ImageIO.read(url)
            ImageIO.write(image, "png", outputFile)
        }
        catch (IOException e) {
            e.printStackTrace()
        }
    }
}

task downloadImg(type: Downloader) {
    urlAddress = "https://check.ofd.ru/assets/bottom-check.ecc8e7e.png"
    String fileName = "build/imgs/" + urlAddress.substring(urlAddress.lastIndexOf('/'), urlAddress.length())
    outputFile = new File(fileName)

}